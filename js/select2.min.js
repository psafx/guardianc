(function(e){if(typeof e.fn.each2=="undefined"){e.fn.extend({each2:function(t){var s=e([0]),i=-1,n=this.length;while(++i<n&&(s.context=s[0]=this[i])&&t.call(s[0],i,s)!==false);return this}})}})(jQuery);(function(e,t){"use strict";if(window.Select2!==t){return}var s,i,n,r,o,l,a,c;s={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case s.LEFT:case s.RIGHT:case s.UP:case s.DOWN:return true}return false},isControl:function(e){var t=e.which;switch(t){case s.SHIFT:case s.CTRL:case s.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(e){e=e.which?e.which:e;return e>=112&&e<=123}};c=e(document);o=function(){var e=1;return function(){return e++}}();function h(e,t){var s=0,i=t.length;for(;s<i;s=s+1){if(u(e,t[s]))return s}return-1}function u(e,s){if(e===s)return true;if(e===t||s===t)return false;if(e===null||s===null)return false;if(e.constructor===String)return e===s+"";if(s.constructor===String)return s===e+"";return false}function d(t,s){var i,n,r;if(t===null||t.length<1)return[];i=t.split(s);for(n=0,r=i.length;n<r;n=n+1)i[n]=e.trim(i[n]);return i}function f(e){return e.outerWidth(false)-e.width()}function p(s){var i="keyup-change-value";s.bind("keydown",function(){if(e.data(s,i)===t){e.data(s,i,s.val())}});s.bind("keyup",function(){var n=e.data(s,i);if(n!==t&&s.val()!==n){e.removeData(s,i);s.trigger("keyup-change")}})}c.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}});function g(s){s.bind("mousemove",function(s){var i=a;if(i===t||i.x!==s.pageX||i.y!==s.pageY){e(s.target).trigger("mousemove-filtered",s)}})}function m(e,s,i){i=i||t;var n;return function(){var t=arguments;window.clearTimeout(n);n=window.setTimeout(function(){s.apply(i,t)},e)}}function v(e){var t=false,s;return function(){if(t===false){s=e();t=true}return s}}function b(e,t){var s=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){if(h(e.target,t.get())>=0)s(e)})}function w(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],s=e.val().length,i;e.focus();if(t.setSelectionRange){t.setSelectionRange(s,s)}else if(t.createTextRange){i=t.createTextRange();i.collapse(true);i.moveEnd("character",s);i.moveStart("character",s);i.select()}},0)}function C(e){e.preventDefault();e.stopPropagation()}function S(e){e.preventDefault();e.stopImmediatePropagation()}function y(t){if(!l){var s=t[0].currentStyle||window.getComputedStyle(t[0],null);l=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:s.fontSize,fontFamily:s.fontFamily,fontStyle:s.fontStyle,fontWeight:s.fontWeight,letterSpacing:s.letterSpacing,textTransform:s.textTransform,whiteSpace:"nowrap"});l.attr("class","select2-sizer");e("body").append(l)}l.text(t.val());return l.width()}function x(t,s,i){var n,r=[],o;n=t.attr("class");if(typeof n==="string"){e(n.split(" ")).each2(function(){if(this.indexOf("select2-")===0){r.push(this)}})}n=s.attr("class");if(typeof n==="string"){e(n.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){o=i(this);if(typeof o==="string"&&o.length>0){r.push(this)}}})}t.attr("class",r.join(" "))}function E(e,t,s,i){var n=e.toUpperCase().indexOf(t.toUpperCase()),r=t.length;if(n<0){s.push(i(e));return}s.push(i(e.substring(0,n)));s.push("<span class='select2-match'>");s.push(i(e.substring(n,n+r)));s.push("</span>");s.push(i(e.substring(n+r,e.length)))}function T(t){var s,i=0,n=null,r=t.quietMillis||100,o=t.url,l=this;return function(a){window.clearTimeout(s);s=window.setTimeout(function(){i+=1;var s=i,r=t.data,c=o,h=t.transport||e.ajax,u=t.type||"GET",d={};r=r?r.call(l,a.term,a.page,a.context):null;c=typeof c==="function"?c.call(l,a.term,a.page,a.context):c;if(null!==n){n.abort()}if(t.params){if(e.isFunction(t.params)){e.extend(d,t.params.call(l))}else{e.extend(d,t.params)}}e.extend(d,{url:c,dataType:t.dataType,data:r,type:u,cache:false,success:function(e){if(s<i){return}var n=t.results(e,a.page);a.callback(n)}});n=h.call(l,d)},r)}}function P(t){var s=t,i,n,r=function(e){return""+e.text};if(e.isArray(s)){n=s;s={results:n}}if(e.isFunction(s)===false){n=s;s=function(){return n}}var o=s();if(o.text){r=o.text;if(!e.isFunction(r)){i=s.text;r=function(e){return e[i]}}}return function(t){var i=t.term,n={results:[]},o;if(i===""){t.callback(s());return}o=function(s,n){var l,a;s=s[0];if(s.children){l={};for(a in s){if(s.hasOwnProperty(a))l[a]=s[a]}l.children=[];e(s.children).each2(function(e,t){o(t,l.children)});if(l.children.length||t.matcher(i,r(l),s)){n.push(l)}}else{if(t.matcher(i,r(s),s)){n.push(s)}}};e(s().results).each2(function(e,t){o(t,n.results)});t.callback(n)}}function k(s){var i=e.isFunction(s);return function(n){var r=n.term,o={results:[]};e(i?s():s).each(function(){var e=this.text!==t,s=e?this.text:this;if(r===""||n.matcher(r,s)){o.results.push(e?this:{id:this,text:this})}});n.callback(o)}}function O(t,s){if(e.isFunction(t))return true;if(!t)return false;throw new Error("formatterName must be a function or a falsy value")}function I(t){return e.isFunction(t)?t():t}function A(t){var s=0;e.each(t,function(e,t){if(t.children){s+=A(t.children)}else{s++}});return s}function R(e,s,i,n){var r=e,o=false,l,a,c,h,d;if(!n.createSearchChoice||!n.tokenSeparators||n.tokenSeparators.length<1)return t;while(true){a=-1;for(c=0,h=n.tokenSeparators.length;c<h;c++){d=n.tokenSeparators[c];a=e.indexOf(d);if(a>=0)break}if(a<0)break;l=e.substring(0,a);e=e.substring(a+d.length);if(l.length>0){l=n.createSearchChoice(l,s);if(l!==t&&l!==null&&n.id(l)!==t&&n.id(l)!==null){o=false;for(c=0,h=s.length;c<h;c++){if(u(n.id(l),n.id(s[c]))){o=true;break}}if(!o)i(l)}}}if(r!==e)return e}function H(t,s){var i=function(){};i.prototype=new t;i.prototype.constructor=i;i.prototype.parent=t.prototype;i.prototype=e.extend(i.prototype,s);return i}i=H(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(s){var i,n,r=".select2-results",l;this.opts=s=this.prepareOpts(s);this.id=s.id;if(s.element.data("select2")!==t&&s.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(s.element.attr("id")||"autogen"+o());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=v(function(){return s.element.closest("body")});x(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(I(s.containerCss));this.container.addClass(I(s.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabIndex");this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(I(s.dropdownCssClass));this.dropdown.data("select2",this);this.results=i=this.container.find(r);this.search=n=this.container.find("input.select2-input");n.attr("tabIndex",this.elementTabIndex);this.resultsPage=0;this.context=null;this.initContainer();g(this.results);this.dropdown.delegate(r,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent));b(80,this.results);this.dropdown.delegate(r,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(e.fn.mousewheel){i.mousewheel(function(e,t,s,n){var r=i.scrollTop(),o;if(n>0&&r-n<=0){i.scrollTop(0);C(e)}else if(n<0&&i.get(0).scrollHeight-i.scrollTop()+n<=i.height()){i.scrollTop(i.get(0).scrollHeight-i.height());C(e)}})}p(n);n.bind("keyup-change input paste",this.bind(this.updateResults));n.bind("focus",function(){n.addClass("select2-focused")});n.bind("blur",function(){n.removeClass("select2-focused")});this.dropdown.delegate(r,"mouseup",this.bind(function(t){if(e(t.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(t);this.selectHighlighted(t)}}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()});if(e.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(s.element.is(":disabled")||s.element.is("[readonly='readonly']"))this.disable()},destroy:function(){var e=this.opts.element.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(e!==t){e.container.remove();e.dropdown.remove();e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show()}},prepareOpts:function(s){var i,n,r,o;i=s.element;if(i.get(0).tagName.toLowerCase()==="select"){this.select=n=s.element}if(n){e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in s){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}s=e.extend({},{populateResults:function(i,n,r){var o,l,a,c,h=this.opts.id,u=this;o=function(i,n,l){var a,c,d,f,p,g,m,v,b,w;i=s.sortResults(i,n,r);for(a=0,c=i.length;a<c;a=a+1){d=i[a];p=d.disabled===true;f=!p&&h(d)!==t;g=d.children&&d.children.length>0;m=e("<li></li>");m.addClass("select2-results-dept-"+l);m.addClass("select2-result");m.addClass(f?"select2-result-selectable":"select2-result-unselectable");if(p){m.addClass("select2-disabled")}if(g){m.addClass("select2-result-with-children")}m.addClass(u.opts.formatResultCssClass(d));v=e(document.createElement("div"));v.addClass("select2-result-label");w=s.formatResult(d,v,r,u.opts.escapeMarkup);if(w!==t){v.html(w)}m.append(v);if(g){b=e("<ul></ul>");b.addClass("select2-result-sub");o(d.children,b,l+1);m.append(b)}m.data("select2-data",d);n.append(m)}};o(n,i,0)}},e.fn.select2.defaults,s);if(typeof s.id!=="function"){r=s.id;s.id=function(e){return e[r]}}if(e.isArray(s.element.data("select2Tags"))){if("tags"in s){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+s.element.attr("id")}s.tags=s.element.attr("data-select2-tags")}if(n){s.query=this.bind(function(s){var n={results:[],more:false},r=s.term,o,l,a;a=function(e,t){var i;if(e.is("option")){if(s.matcher(r,e.text(),e)){t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:u(e.attr("disabled"),"disabled")})}}else if(e.is("optgroup")){i={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")};e.children().each2(function(e,t){a(t,i.children)});if(i.children.length>0){t.push(i)}}};o=i.children();if(this.getPlaceholder()!==t&&o.length>0){l=o[0];if(e(l).text()===""){o=o.not(l)}}o.each2(function(e,t){a(t,n.results)});s.callback(n)});s.id=function(e){return e.id};s.formatResultCssClass=function(e){return e.css}}else{if(!("query"in s)){if("ajax"in s){o=s.element.data("ajax-url");if(o&&o.length>0){s.ajax.url=o}s.query=T.call(s.element,s.ajax)}else if("data"in s){s.query=P(s.data)}else if("tags"in s){s.query=k(s.tags);if(s.createSearchChoice===t){s.createSearchChoice=function(e){return{id:e,text:e}}}if(s.initSelection===t){s.initSelection=function(t,i){var n=[];e(d(t.val(),s.separator)).each(function(){var t=this,i=this,r=s.tags;if(e.isFunction(r))r=r();e(r).each(function(){if(u(this.id,t)){i=this.text;return false}});n.push({id:t,text:i})});i(n)}}}}}if(typeof s.query!=="function"){throw"query function not defined for Select2 "+s.element.attr("id")}return s},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));t=this.bind(function(){var e,t,s=this;e=this.opts.element.attr("disabled")!=="disabled";t=this.opts.element.attr("readonly")==="readonly";e=e&&!t;if(this.enabled!==e){if(e){this.enable()}else{this.disable()}}x(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(I(this.opts.containerCssClass));x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(I(this.opts.dropdownCssClass))});e.bind("propertychange.select2 DOMAttrModified.select2",t);if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)});this.propertyObserver.observe(e.get(0),{attributes:true,subtree:false})}},triggerChange:function(t){t=t||{};t=e.extend({},t,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(t);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass("select2-container-disabled");this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass("select2-container-disabled");this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),s=this.container.outerHeight(false),i=this.container.outerWidth(false),n=this.dropdown.outerHeight(false),r=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),l=t.top+s,a=t.left,c=l+n<=o,h=t.top-n>=this.body().scrollTop(),u=this.dropdown.outerWidth(false),d=a+u<=r,f=this.dropdown.hasClass("select2-drop-above"),p,g,m;if(this.body().css("position")!=="static"){p=this.body().offset();l-=p.top;a-=p.left}if(f){g=true;if(!h&&c)g=false}else{g=false;if(!c&&h)g=true}if(!d){a=t.left+i-u}if(g){l=t.top-n;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}m=e.extend({top:l,left:a,width:i},I(this.opts.dropdownCss));this.dropdown.css(m)},shouldOpen:function(){var t;if(this.opened())return false;t=e.Event("opening");this.opts.element.trigger(t);return!t.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var t=this.containerId,s="scroll."+t,i="resize."+t,n="orientationchange."+t,r;this.clearDropdownAlignmentPreference();this.container.addClass("select2-dropdown-open").addClass("select2-container-active");if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.updateResults(true);r=e("#select2-drop-mask");if(r.length==0){r=e(document.createElement("div"));r.attr("id","select2-drop-mask").attr("class","select2-drop-mask");r.hide();r.appendTo(this.body());r.bind("mousedown touchstart",function(t){var s=e("#select2-drop"),i;if(s.length>0){i=s.data("select2");if(i.opts.selectOnBlur){i.selectHighlighted({noFocus:true})}i.close()}})}if(this.dropdown.prev()[0]!==r[0]){this.dropdown.before(r)}e("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");r.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});r.show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(i+" "+s+" "+n,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});o.positionDropdown()})});this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,s="scroll."+t,i="resize."+t,n="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(s).unbind(i).unbind(n)});this.clearDropdownAlignmentPreference();e("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return I(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,s,i,n,r,o,l,a;i=this.highlight();if(i<0)return;if(i==0){t.scrollTop(0);return}s=this.findHighlightableChoices();n=e(s[i]);r=n.offset().top+n.outerHeight(true);if(i===s.length-1){a=t.find("li.select2-more-results");if(a.length>0){r=a.offset().top+a.outerHeight(true)}}o=t.offset().top+t.outerHeight(true);if(r>o){t.scrollTop(t.scrollTop()+(r-o))}l=n.offset().top-t.offset().top;if(l<0&&n.css("display")!="none"){t.scrollTop(t.scrollTop()+l)}},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var s=this.findHighlightableChoices(),i=this.highlight();while(i>-1&&i<s.length){i+=t;var n=e(s[i]);if(n.hasClass("select2-result-selectable")&&!n.hasClass("select2-disabled")&&!n.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var s=this.findHighlightableChoices(),i,n;if(arguments.length===0){return h(s.filter(".select2-highlighted")[0],s.get())}if(t>=s.length)t=s.length-1;if(t<0)t=0;this.results.find(".select2-highlighted").removeClass("select2-highlighted");i=e(s[t]);i.addClass("select2-highlighted");this.ensureHighlightVisible();n=i.data("select2-data");if(n){this.opts.element.trigger({type:"highlight",val:this.id(n),choice:n})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var s=e(t.target).closest(".select2-result-selectable");if(s.length>0&&!s.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(s))}else if(s.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),s,i=-1,n=this.resultsPage+1,r=this,o=this.search.val(),l=this.context;if(t.length===0)return;s=t.offset().top-e.offset().top-e.height();if(s<=this.opts.loadMorePadding){t.addClass("select2-active");this.opts.query({element:this.opts.element,term:o,page:n,context:l,matcher:this.opts.matcher,callback:this.bind(function(s){if(!r.opened())return;r.opts.populateResults.call(this,e,s.results,{term:o,page:n,context:l});if(s.more===true){t.detach().appendTo(e).text(r.opts.formatLoadMore(n+1));window.setTimeout(function(){r.loadMoreIfNeeded()},10)}else{t.remove()}r.positionDropdown();r.resultsPage=n;r.context=s.context})})}},tokenize:function(){},updateResults:function(s){var i=this.search,n=this.results,r=this.opts,o,l=this,a;if(s!==true&&(this.showSearchInput===false||!this.opened())){return}i.addClass("select2-active");function c(){n.scrollTop(0);i.removeClass("select2-active");l.positionDropdown()}function h(e){n.html(e);c()}var d=this.getMaximumSelectionSize();if(d>=1){o=this.data();if(e.isArray(o)&&o.length>=d&&O(r.formatSelectionTooBig,"formatSelectionTooBig")){h("<li class='select2-selection-limit'>"+r.formatSelectionTooBig(d)+"</li>");return}}if(i.val().length<r.minimumInputLength){if(O(r.formatInputTooShort,"formatInputTooShort")){h("<li class='select2-no-results'>"+r.formatInputTooShort(i.val(),r.minimumInputLength)+"</li>")}else{h("")}return}else if(r.formatSearching()&&s===true){h("<li class='select2-searching'>"+r.formatSearching()+"</li>")}if(r.maximumInputLength&&i.val().length>r.maximumInputLength){if(O(r.formatInputTooLong,"formatInputTooLong")){h("<li class='select2-no-results'>"+r.formatInputTooLong(i.val(),r.maximumInputLength)+"</li>")}else{h("")}return}a=this.tokenize();if(a!=t&&a!=null){i.val(a)}this.resultsPage=1;r.query({element:r.element,term:i.val(),page:this.resultsPage,context:null,matcher:r.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context;if(this.opts.createSearchChoice&&i.val()!==""){a=this.opts.createSearchChoice.call(null,i.val(),o.results);if(a!==t&&a!==null&&l.id(a)!==t&&l.id(a)!==null){if(e(o.results).filter(function(){return u(l.id(this),l.id(a))}).length===0){o.results.unshift(a)}}}if(o.results.length===0&&O(r.formatNoMatches,"formatNoMatches")){h("<li class='select2-no-results'>"+r.formatNoMatches(i.val())+"</li>");return}n.empty();l.opts.populateResults.call(this,n,o.results,{term:i.val(),page:this.resultsPage,context:null});if(o.more===true&&O(r.formatLoadMore,"formatLoadMore")){n.append("<li class='select2-more-results'>"+l.opts.escapeMarkup(r.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){l.loadMoreIfNeeded()},10)}this.postprocessResults(o,s);c()})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur)this.selectHighlighted({noFocus:true});this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){w(this.search)},selectHighlighted:function(e){var t=this.highlight(),s=this.results.find(".select2-highlighted"),i=s.closest(".select2-result").data("select2-data");if(i){this.highlight(t);this.onSelect(i,e)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function s(){var s,i,n,r,o;if(this.opts.width==="off"){return null}else if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else if(this.opts.width==="copy"||this.opts.width==="resolve"){s=this.opts.element.attr("style");if(s!==t){i=s.split(";");for(r=0,o=i.length;r<o;r=r+1){n=i[r].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(n!==null&&n.length>=1)return n[1]}}if(this.opts.width==="resolve"){s=this.opts.element.css("width");if(s.indexOf("%")>0)return s;return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}return null}else if(e.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var i=s.call(this);if(i!==null){this.container.css("width",i)}}});n=H(i,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments);this.focusser.attr("disabled","disabled");this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");w(this.focusser)},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var e,t=this.container,i=this.dropdown,n=false;this.showSearch(this.opts.minimumResultsForSearch>=0);this.selection=e=t.find(".select2-choice");this.focusser=t.find(".select2-focusser");this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.PAGE_UP||e.which===s.PAGE_DOWN){C(e);return}switch(e.which){case s.UP:case s.DOWN:this.moveHighlight(e.which===s.UP?-1:1);C(e);return;case s.TAB:case s.ENTER:this.selectHighlighted();C(e);return;case s.ESC:this.cancel(e);C(e);return}}));this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.TAB||s.isControl(e)||s.isFunctionKey(e)||e.which===s.ESC){return}if(this.opts.openOnEnter===false&&e.which===s.ENTER){C(e);return}if(e.which==s.DOWN||e.which==s.UP||e.which==s.ENTER&&this.opts.openOnEnter){this.open();C(e);return}if(e.which==s.DELETE||e.which==s.BACKSPACE){if(this.opts.allowClear){this.clear()}C(e);return}}));p(this.focusser);this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open();if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.focusser.val("");C(e)}));e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear();S(e);this.close();this.triggerChange();this.selection.focus()}));e.bind("mousedown",this.bind(function(e){n=true;if(this.opened()){this.close()}else if(this.enabled){this.open()}C(e);n=false}));i.bind("mousedown",this.bind(function(){this.search.focus()}));e.bind("focus",this.bind(function(e){C(e)}));this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}}));this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}));this.initContainerWidth();this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();this.opts.element.trigger({type:"removed",val:this.id(e),choice:e});this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.close();this.setPlaceholder()}else{var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.setPlaceholder()}})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(t,s){var i=t.find(":selected");if(e.isFunction(s))s({id:i.attr("value"),text:i.text(),element:i})}}else if("data"in t){t.initSelection=t.initSelection||function(s,i){var n=s.val();t.query({matcher:function(e,s,i){return u(n,t.id(i))},callback:!e.isFunction(i)?e.noop:function(e){i(e.results.length?e.results[0]:null)}})}}return t},getPlaceholder:function(){if(this.select){if(this.select.find("option").first().text()!==""){return t}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var s=0,i=this,n=true;this.findHighlightableChoices().each2(function(e,t){if(u(i.id(t.data("select2-data")),i.opts.element.val())){s=e;return false}});this.highlight(s);if(t===true){var r=this.opts.minimumResultsForSearch;n=r<0?false:A(e.results)>=r;this.showSearch(n)}},showSearch:function(t){this.showSearchInput=t;this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden");e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var s=this.opts.element.val();this.opts.element.val(this.id(e));this.updateSelection(e);this.opts.element.trigger({type:"selected",val:this.id(e),choice:e});this.close();if(!t||!t.noFocus)this.selection.focus();if(!u(s,this.id(e))){this.triggerChange()}},updateSelection:function(e){var s=this.selection.find("span"),i;this.selection.data("select2-data",e);s.empty();i=this.opts.formatSelection(e,s);if(i!==t){s.append(this.opts.escapeMarkup(i))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==t){this.selection.find("abbr").show()}},val:function(){var e,s=false,i=null,n=this;if(arguments.length===0){return this.opts.element.val()}e=arguments[0];if(arguments.length>1){s=arguments[1]}if(this.select){this.select.val(e).find(":selected").each2(function(e,t){i={id:t.attr("value"),text:t.text()};return false});this.updateSelection(i);this.setPlaceholder();if(s){this.triggerChange()}}else{if(this.opts.initSelection===t){throw new Error("cannot call val() if initSelection() is not defined")}if(!e&&e!==0){this.clear();if(s){this.triggerChange()}return}this.opts.element.val(e);this.opts.initSelection(this.opts.element,function(e){n.opts.element.val(!e?"":n.id(e));n.updateSelection(e);n.setPlaceholder();if(s){n.triggerChange()}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(e){var s;if(arguments.length===0){s=this.selection.data("select2-data");if(s==t)s=null;return s}else{if(!e||e===""){this.clear()}else{this.opts.element.val(!e?"":this.id(e));this.updateSelection(e)}}}});r=H(i,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(e,t){var s=[];e.find(":selected").each2(function(e,t){s.push({id:t.attr("value"),text:t.text(),element:t[0]})});t(s)}}else if("data"in t){t.initSelection=t.initSelection||function(s,i){var n=d(s.val(),t.separator);t.query({matcher:function(s,i,r){return e.grep(n,function(e){return u(e,t.id(r))}).length},callback:!e.isFunction(i)?e.noop:function(e){i(e.results)}})}}return t},initContainer:function(){var t=".select2-choices",i;this.searchContainer=this.container.find(".select2-search-field");this.selection=i=this.container.find(t);this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;if(!this.opened()){this.open()}}));this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.BACKSPACE&&this.search.val()===""){this.close();var t,n=i.find(".select2-search-choice-focus");if(n.length>0){this.unselect(n.first());this.search.width(10);C(e);return}t=i.find(".select2-search-choice:not(.select2-locked)");if(t.length>0){t.last().addClass("select2-search-choice-focus")}}else{i.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(e.which){case s.UP:case s.DOWN:this.moveHighlight(e.which===s.UP?-1:1);C(e);return;case s.ENTER:case s.TAB:this.selectHighlighted();C(e);return;case s.ESC:this.cancel(e);C(e);return}}if(e.which===s.TAB||s.isControl(e)||s.isFunctionKey(e)||e.which===s.BACKSPACE||e.which===s.ESC){return}if(e.which===s.ENTER){if(this.opts.openOnEnter===false){return}else if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return}}this.open();if(e.which===s.PAGE_UP||e.which===s.PAGE_DOWN){C(e)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");
if(!this.opened())this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();t.preventDefault()}));this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();if(e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(e).addClass("select2-default");this.resizeSearch()}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch();this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus();this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var s=[],i=[],n=this;e(t).each(function(){if(h(n.id(this),s)<0){s.push(n.id(this));i.push(this)}});t=i;this.selection.find(".select2-search-choice").remove();e(t).each(function(){n.addSelectedChoice(this)});n.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts);if(e!=null&&e!=t){this.search.val(e);if(e.length>0){this.open()}}},onSelect:function(e,t){this.addSelectedChoice(e);this.opts.element.trigger({type:"selected",val:this.id(e),choice:e});if(this.select||!this.opts.closeOnSelect)this.postprocessResults();if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:e});if(!t||!t.noFocus)this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(s){var i=!s.locked,n=e("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>"+"</li>"),r=e("<li class='select2-search-choice select2-locked'>"+"<div></div>"+"</li>");var o=i?n:r,l=this.id(s),a=this.getVal(),c;c=this.opts.formatSelection(s,o.find("div"));if(c!=t){o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(c)+"</div>")}if(i){o.find(".select2-search-choice-close").bind("mousedown",C).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();C(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}o.data("select2-data",s);o.insertBefore(this.searchContainer);a.push(l);this.setVal(a)},unselect:function(e){var t=this.getVal(),s,i;e=e.closest(".select2-search-choice");if(e.length===0){throw"Invalid argument: "+e+". Must be .select2-search-choice"}s=e.data("select2-data");if(!s){return}i=h(this.id(s),t);if(i>=0){t.splice(i,1);this.setVal(t);if(this.select)this.postprocessResults()}e.remove();this.opts.element.trigger({type:"removed",val:this.id(s),choice:s});this.triggerChange({removed:s})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),i=this;t.each2(function(t,s){var n=i.id(s.data("select2-data"));if(h(n,e)>=0){s.addClass("select2-selected");s.find(".select2-result-selectable").addClass("select2-selected")}});s.each2(function(e,t){if(!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0){t.addClass("select2-selected")}});if(this.highlight()==-1){i.highlight(0)}},resizeSearch:function(){var e,t,s,i,n,r=f(this.search);e=y(this.search)+10;t=this.search.offset().left;s=this.selection.width();i=this.selection.offset().left;n=s-(t-i)-r;if(n<e){n=s-r}if(n<40){n=s-r}if(n<=0){n=e}this.search.width(n)},getVal:function(){var e;if(this.select){e=this.select.val();return e===null?[]:e}else{e=this.opts.element.val();return d(e,this.opts.separator)}},setVal:function(t){var s;if(this.select){this.select.val(t)}else{s=[];e(t).each(function(){if(h(this,s)<0)s.push(this)});this.opts.element.val(s.length===0?"":s.join(this.opts.separator))}},val:function(){var s,i=false,n=[],r=this;if(arguments.length===0){return this.getVal()}s=arguments[0];if(arguments.length>1){i=arguments[1]}if(!s&&s!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(i){this.triggerChange()}return}this.setVal(s);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(i){this.triggerChange()}}else{if(this.opts.initSelection===t){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var s=e(t).map(r.id);r.setVal(s);r.updateSelection(t);r.clearSearch();if(i){r.triggerChange()}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var t=[],s=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){t.push(s.opts.id(e(this).data("select2-data")))});this.setVal(t);this.triggerChange()},data:function(t){var s=this,i;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get()}else{if(!t){t=[]}i=e.map(t,function(e){return s.opts.id(e)});this.setVal(i);this.updateSelection(t);this.clearSearch()}}});e.fn.select2=function(){var s=Array.prototype.slice.call(arguments,0),i,o,l,a,c=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(s.length===0||typeof s[0]==="object"){i=s.length===0?{}:e.extend({},s[0]);i.element=e(this);if(i.element.get(0).tagName.toLowerCase()==="select"){a=i.element.attr("multiple")}else{a=i.multiple||false;if("tags"in i){i.multiple=a=true}}o=a?new r:new n;o.init(i)}else if(typeof s[0]==="string"){if(h(s[0],c)<0){throw"Unknown method: "+s[0]}l=t;o=e(this).data("select2");if(o===t)return;if(s[0]==="container"){l=o.container}else{l=o[s[0]].apply(o,s.slice(1))}if(l!==t){return false}}else{throw"Invalid arguments to select2 plugin: "+s}});return l===t?this:l};e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,s,i){var n=[];E(e.text,s.term,n,i);return n.join("")},formatSelection:function(e,s){return e?e.text:t},sortResults:function(e,t,s){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var s=t-e.length;return"Please enter "+s+" more character"+(s==1?"":"s")},formatInputTooLong:function(e,t){var s=e.length-t;return"Please enter "+s+" less character"+(s==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:R,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}};window.Select2={query:{ajax:T,local:P,tags:k},util:{debounce:m,markMatch:E},"class":{"abstract":i,single:n,multi:r}}})(jQuery);